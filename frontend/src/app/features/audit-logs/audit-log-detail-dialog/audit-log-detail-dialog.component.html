<h2 mat-dialog-title>Audit Log Details (Updated)</h2>
<mat-dialog-content>
    <div class="summary-section">
        <div class="detail-row">
            <span class="label">Time:</span>
            <span class="value">{{ data.createdAt | appDate: 'medium' }}</span>
        </div>
        <div class="detail-row">
            <span class="label">Action:</span>
            <span class="value">{{ data.action }}</span>
        </div>
        <div class="detail-row">
            <span class="label">Entity Type:</span>
            <span class="value">{{ data.entityType }}</span>
        </div>
        <div class="detail-row">
            <span class="label">Entity ID:</span>
            <span class="value">{{ data.entityId }}</span>
        </div>
        <div class="detail-row">
            <span class="label">Source:</span>
            <span class="value">{{ data.changeSource }}</span>
        </div>
        <div class="detail-row">
            <span class="label">User:</span>
            <span class="value">{{ data.userId }}</span>
        </div>
    </div>

    <mat-divider></mat-divider>

    <div class="diff-container" *ngIf="diffRows.length > 0">
        <table class="diff-table">
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Before</th>
                    <th>After</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let row of diffRows" [ngClass]="row.status">
                    <td class="key-cell">{{ row.key }}</td>
                    <td class="value-cell before">{{ row.before }}</td>
                    <td class="value-cell after">{{ row.after }}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div *ngIf="diffRows.length === 0 && (data.before || data.after)" class="no-changes">
        No changes detected or raw data available.
        <pre *ngIf="data.before">{{ data.before }}</pre>
        <pre *ngIf="data.after">{{ data.after }}</pre>
    </div>
</mat-dialog-content>
<mat-dialog-actions align="end">
    <button mat-button (click)="close()">Close</button>
</mat-dialog-actions>
